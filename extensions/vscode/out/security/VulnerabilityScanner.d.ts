import { EchoAIProvider } from '../providers/EchoAIProvider';
import { CodebaseIndexer, IndexedFile } from '../services/CodebaseIndexer';
export interface SecurityVulnerability {
    id: string;
    type: VulnerabilityType;
    severity: 'critical' | 'high' | 'medium' | 'low' | 'info';
    title: string;
    description: string;
    location: {
        file: string;
        line: number;
        column: number;
        endLine?: number;
        endColumn?: number;
    };
    cwe?: string;
    owasp?: string;
    evidence: string;
    impact: string;
    remediation: SecurityRemediation;
    confidence: number;
    category: SecurityCategory;
    references: string[];
    affectedCode: string;
}
export type VulnerabilityType = 'sql_injection' | 'xss_reflected' | 'xss_stored' | 'xss_dom' | 'csrf' | 'hardcoded_secret' | 'weak_crypto' | 'insecure_random' | 'path_traversal' | 'open_redirect' | 'xxe' | 'ldap_injection' | 'command_injection' | 'code_injection' | 'deserialization' | 'sensitive_data_exposure' | 'broken_authentication' | 'session_fixation' | 'privilege_escalation' | 'race_condition' | 'buffer_overflow' | 'integer_overflow' | 'null_pointer' | 'memory_leak' | 'dos_vulnerability' | 'weak_password_policy' | 'missing_authorization' | 'improper_input_validation' | 'insecure_transport' | 'certificate_validation' | 'cors_misconfiguration' | 'security_misconfiguration';
export type SecurityCategory = 'injection' | 'authentication' | 'session_management' | 'access_control' | 'security_misconfiguration' | 'sensitive_data_exposure' | 'insufficient_logging' | 'deserialization' | 'components_with_vulnerabilities' | 'cryptography' | 'business_logic' | 'client_side';
export interface SecurityRemediation {
    description: string;
    steps: string[];
    codeExample?: string;
    automated: boolean;
    effort: 'low' | 'medium' | 'high';
    priority: number;
}
export interface SecurityScanResult {
    scanId: string;
    timestamp: number;
    vulnerabilities: SecurityVulnerability[];
    summary: {
        total: number;
        critical: number;
        high: number;
        medium: number;
        low: number;
        info: number;
    };
    coverage: {
        filesScanned: number;
        linesScanned: number;
        functions: number;
        endpoints: number;
    };
    riskScore: number;
    complianceStatus: {
        owasp: boolean;
        pci: boolean;
        gdpr: boolean;
        hipaa: boolean;
    };
}
export interface SecurityRule {
    id: string;
    name: string;
    description: string;
    category: SecurityCategory;
    severity: SecurityVulnerability['severity'];
    pattern: RegExp | string;
    languages: string[];
    enabled: boolean;
    aiEnhanced: boolean;
}
export declare class VulnerabilityScanner {
    private echoProvider;
    private codebaseIndexer;
    private codeAnalyzer;
    private securityRules;
    private scanResults;
    private readonly CACHE_DURATION;
    private aiPatterns;
    private currentScan?;
    constructor(echoProvider: EchoAIProvider, codebaseIndexer: CodebaseIndexer);
    scanWorkspace(options?: {
        includeTests?: boolean;
        severity?: SecurityVulnerability['severity'][];
        categories?: SecurityCategory[];
        aiEnhanced?: boolean;
    }): Promise<SecurityScanResult>;
    scanFile(file: IndexedFile, options?: any): Promise<SecurityVulnerability[]>;
    private runStaticAnalysis;
    private runPatternDetection;
    private runLanguageSpecificAnalysis;
    private analyzeJavaScriptSecurity;
    private analyzePythonSecurity;
    private analyzeJavaSecurity;
    private analyzeCSharpSecurity;
    private runDataFlowAnalysis;
    private enhanceVulnerabilitiesWithAI;
    private aiSecurityAnalysis;
    private getWorkspaceFiles;
    private filterFilesForScanning;
    private isTestFile;
    private updateScanProgress;
    private generateScanId;
    private generateVulnerabilityId;
    private createVulnerability;
    private deduplicateVulnerabilities;
    private generateSummary;
    private calculateRiskScore;
    private assessCompliance;
    private countEndpoints;
    private identifyDataSources;
    private identifyDataSinks;
    private hasUnsanitizedPath;
    private initializeSecurityRules;
    private addDefaultSecurityRules;
    getCurrentScanProgress(): {
        id: string;
        progress: number;
        status: string;
        startTime: number;
    };
    getScanResult(scanId: string): SecurityScanResult | undefined;
    getLatestScanResult(): SecurityScanResult | undefined;
    clearScanResults(): void;
}
//# sourceMappingURL=VulnerabilityScanner.d.ts.map